---
# tasks file for master_prep
- name: Check for ca-chain.ppem
  local_action: stat path=/root/ca-chain.pem
  register: ca_chain_file

- name: create /etc/origin/master
  file:
    state: directory
    path: /etc/origin/master
  when: idmserver is defined or ca_chain_file.stat.exists

- name: copy CA certificate from IdM server
  get_url:
    url: https://{{idmserver}}/ipa/config/ca.crt
    dest: /etc/origin/ipa.crt
  when: idmserver is defined

- name: Copy CA chain certificate
  copy:
    src: /root/ca-chain.pem
    dest: /etc/origin/master/ca-chain.pem
  when: ca_chain_file.stat.exists


